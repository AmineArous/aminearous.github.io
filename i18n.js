const translations = {
    fr: {
        tagline: " iOS Engineer",
        "tagline-sub": "Passionné par l'écosystème Apple",
        experience: "Expérience Professionnelle",
        myApps: "Mes Applications",
        footer: "© 2025 Amine Arous. Tous droits réservés.",
        "nav-experience": "Expérience",
        "nav-portfolio": "Portfolio",
        "exp-accor-role": "Senior iOS Developer",
        "exp-accor-desc": "Application All.com - Optimisation de l'architecture, développement de nouvelles fonctionnalités (Accor Deals, Year in Review), amélioration de la qualité.",
        "exp-meetic-role": "Senior iOS Developer",
        "exp-meetic-desc": "Applications Meetic, DisonsDemain, Match - Développement de fonctionnalités in-app, release manager pour 8 applications.",
        "exp-pj-role": "Senior iOS Developer / Tech Lead",
        "exp-pj-desc": "Application PagesJaunes iOS - Tech Lead, développement iOS 14 Widget, App Clip, extension Siri, maintenance CI/CD Bitrise.",
        "exp-stime-role": "Senior Mobile Developer",
        "exp-stime-desc": "Application Drive Intermarché - Gestion des lots, modification de commandes, gestion de stock.",
        "exp-accor-details": "• Développement de la feature Accor Deals (offres promotionnelles)\n• Implémentation du Year in Review personnalisé\n• Refactoring de l'architecture vers MVVM + Combine\n• Migration progressive vers SwiftUI\n• Amélioration de la couverture de tests unitaires",
        "exp-meetic-details": "• Release manager pour 8 applications (Meetic, DisonsDemain, Match...)\n• Développement de nouvelles fonctionnalités de matching\n• Intégration de A/B testing pour optimiser les conversions\n• Automatisation des releases avec Fastlane\n• Collaboration avec les équipes produit internationales",
        "exp-pj-details": "• Tech Lead d'une équipe de 4 développeurs iOS\n• Développement du Widget iOS 14 (WidgetKit)\n• Création de l'App Clip pour la recherche rapide\n• Intégration de Siri Shortcuts\n• Mise en place et maintenance du CI/CD avec Bitrise\n• Migration progressive d'Objective-C vers Swift",
        "exp-stime-details": "• Développement de la fonctionnalité de gestion des lots\n• Implémentation de la modification de commandes en temps réel\n• Intégration du système de gestion de stock\n• Optimisation des performances de l'application\n• Collaboration avec l'équipe backend sur les APIs REST",
        "exp-smartfingers-role": "Développeur Mobile",
        "exp-smartfingers-desc": "Agence mobile - Développement d'applications iOS/Android pour Le Journal du Dimanche, Renault Trucks, Pathé, Krys...",
        "exp-smartfingers-details": "• Développement d'applications iPhone : Le Journal du Dimanche, Unifrance, Le Petit Paumé, Grazia Shopping\n• Développement d'applications iPad : Renault Trucks, Volvo, Pathé, Krys\n• Développement de web services et gestion de bases de données\n• Responsabilité opérationnelle de multiples projets mobiles\n• Veille technologique",
        "cat-productivity": "Productivité",
        "cat-health": "Santé & Fitness",
        "cat-games": "Jeux",
        "goal-price": "2,99 €",
        "rituo-desc": "Construisez la meilleure version de vous-même. Suivi d'habitudes intelligent avec coach IA, statistiques détaillées et Apple Watch.",
        "mealwise-desc": "Suivez votre nutrition quotidienne avec une app qui respecte votre vie privée. Vos données restent sur vos appareils.",
        "tictactoe-desc": "Le jeu de morpion ultime avec des graphismes étonnants. Jouez en solo ou affrontez des joueurs du monde entier.",
        "warship-desc": "Embarquez pour une aventure maritime palpitante ! Jouez en solo ou défiez des joueurs du monde entier.",
        "crossword-desc": "Prêt pour un nouveau défi de mots ? Des grilles dynamiques générées à l'infini pour des heures de divertissement.",
        "motscroises-desc": "Des grilles de mots croisés générées aléatoirement avec trois niveaux de difficulté pour les amateurs de langue française.",
        "brainquiz-desc": "Un jeu de puzzle innovant et addictif qui met à l'épreuve vos compétences logiques et mathématiques.",
        "goal-desc": "Un jeu de puzzle où vous devez marquer des buts sur un terrain de foot 2D. Stratégie et réflexion au rendez-vous !",
        "puzzlo-desc": "Un jeu fun et addictif qui met au défi vos compétences en puzzle. Combinez les blocs pour atteindre 4096 !",
        "screenshots-coming": "Screenshots bientôt disponibles"
    },
    en: {
        tagline: " iOS Engineer",
        "tagline-sub": "Apple ecosystem enthusiast",
        experience: "Professional Experience",
        myApps: "My Applications",
        footer: "© 2025 Amine Arous. All rights reserved.",
        "nav-experience": "Experience",
        "nav-portfolio": "Portfolio",
        "exp-accor-role": "Senior iOS Developer",
        "exp-accor-desc": "All.com App - Architecture optimization, new features development (Accor Deals, Year in Review), quality improvement.",
        "exp-meetic-role": "Senior iOS Developer",
        "exp-meetic-desc": "Meetic, DisonsDemain, Match Apps - In-app features development, release manager for 8 applications.",
        "exp-pj-role": "Senior iOS Developer / Tech Lead",
        "exp-pj-desc": "PagesJaunes iOS App - Tech Lead, iOS 14 Widget, App Clip, Siri extension development, CI/CD Bitrise maintenance.",
        "exp-stime-role": "Senior Mobile Developer",
        "exp-stime-desc": "Drive Intermarché App - Lot management, order modification, stock management.",
        "exp-accor-details": "• Development of the Accor Deals feature (promotional offers)\n• Implementation of personalized Year in Review\n• Architecture refactoring to MVVM + Combine\n• Progressive migration to SwiftUI\n• Improvement of unit test coverage",
        "exp-meetic-details": "• Release manager for 8 applications (Meetic, DisonsDemain, Match...)\n• Development of new matching features\n• A/B testing integration to optimize conversions\n• Release automation with Fastlane\n• Collaboration with international product teams",
        "exp-pj-details": "• Tech Lead of a team of 4 iOS developers\n• Development of iOS 14 Widget (WidgetKit)\n• Creation of App Clip for quick search\n• Integration of Siri Shortcuts\n• Setup and maintenance of CI/CD with Bitrise\n• Progressive migration from Objective-C to Swift",
        "exp-stime-details": "• Development of the lot management feature\n• Implementation of real-time order modification\n• Integration of stock management system\n• Application performance optimization\n• Collaboration with backend team on REST APIs",
        "exp-smartfingers-role": "Mobile Developer",
        "exp-smartfingers-desc": "Mobile agency - iOS/Android app development for Le Journal du Dimanche, Renault Trucks, Pathé, Krys...",
        "exp-smartfingers-details": "• iPhone app development: Le Journal du Dimanche, Unifrance, Le Petit Paumé, Grazia Shopping\n• iPad app development: Renault Trucks, Volvo, Pathé, Krys\n• Web services development and database management\n• Operational responsibility for multiple mobile projects\n• Technology watch",
        "cat-productivity": "Productivity",
        "cat-health": "Health & Fitness",
        "cat-games": "Games",
        "goal-price": "$2.99",
        "rituo-desc": "Build the best version of yourself. Smart habit tracking with AI coach, detailed statistics and Apple Watch support.",
        "mealwise-desc": "Track your daily nutrition with an app that respects your privacy. Your data stays on your devices.",
        "tictactoe-desc": "The ultimate Tic Tac Toe game with stunning graphics. Play solo or challenge players from around the world.",
        "warship-desc": "Embark on an exciting maritime adventure! Play solo or challenge players from around the world.",
        "crossword-desc": "Ready for a new word challenge? Infinite dynamic grids generated for hours of entertainment.",
        "motscroises-desc": "Randomly generated crossword grids with three difficulty levels for French language enthusiasts.",
        "brainquiz-desc": "An innovative and addictive puzzle game that tests your logical and mathematical skills.",
        "goal-desc": "A puzzle game where you score goals on a 2D soccer field. Strategy and thinking await!",
        "puzzlo-desc": "A fun and addictive game that challenges your puzzle skills. Combine blocks to reach 4096!",
        "screenshots-coming": "Screenshots coming soon"
    }
};

let currentLang = 'fr';

function setLanguage(lang) {
    currentLang = lang;
    document.documentElement.lang = lang;

    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang][key]) {
            el.textContent = translations[lang][key];
        }
    });

    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.lang === lang);
    });

    // Update App Store badges (handles both language and theme)
    if (typeof updateAppStoreBadges === 'function') {
        updateAppStoreBadges();
    }

    localStorage.setItem('preferred-lang', lang);
}

document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', () => setLanguage(btn.dataset.lang));
});

// Detect browser/device language
function getDefaultLanguage() {
    const browserLang = navigator.language || navigator.userLanguage;
    // Check if browser language starts with 'fr' (fr, fr-FR, fr-CA, etc.)
    return browserLang.startsWith('fr') ? 'fr' : 'en';
}

// Apply language after DOM is fully loaded (including dynamic content)
document.addEventListener('DOMContentLoaded', () => {
    const savedLang = localStorage.getItem('preferred-lang') || getDefaultLanguage();
    // Small delay to ensure dynamic content is rendered
    setTimeout(() => setLanguage(savedLang), 10);
});
